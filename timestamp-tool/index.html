<html>
  <head>
  <title>Timestamp tools</title>
  <style type="text/css">

.clearfix:after {
  content: ".";
  display: block;
  height: 0;
  clear: both;
  visibility: hidden;
  }

h1 {
  text-align:center;
  font-size:130%;
  margin-bottom:0;
}

.tagline {
  text-align:center;
  font-size:80%;
  color:#777;
  margin-bottom:30px;
}

h2 {
  font-size:105%;
  margin:5px 0;
}

h3 {
  font-size:103%;
  margin:0;
}

.wrapper {
  width : 900px;
  border: 1px solid #ccc;
  margin: 0 auto;
  padding: 10px;
}

.content-block {
  width : 400px;
  margin : 10px;
  padding : 10px;
  border : 1px solid #aaa;
}

.time-table tr td {
  padding-top:5px;
}

.inner-block {
  border:1px solid #bbb;
  padding:3px;
  margin:5px 0;
}

ul {
  list-style:none;
}

.create-date-table td {
    font-size:12px;
    text-align:center;
}


.normalbutton {
    border:1px solid #000;
    background-color:#eee;
}

  </style>
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2819287-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

  </script>
  </head>
  <body>
    <h1> Timestamp Tools </h1>
    <div class="tagline">Calculate Timestamp</div>
    <div class="wrapper clearfix">
      <div style="float:left;">
        <div class="content-block">
          <input id="copybtn" class="normalbutton"  type="button" style="float:right;" value="Copy->">
          <input id="toggleupdate" class="normalbutton"  type="button" style="float:right;" value="Pause">
          <h2>Current : </h2>
          <table class="time-table">
            <tr> <td> Time </td><td>: <span id="current-timestamp-human"></span></td></tr>
            <tr> <td> Timezone </td><td>: <span id="current-timezone-human"></span></td></tr>
            <tr> <td> Timestamp </td><td>: <input type="text" id="current-timestamp" value=''></td></tr>
          </table>
        </div>
        <div class="content-block">
          <input id="copy-create-btn" class="normalbutton"  type="button" style="float:right;" value="Copy->">
          <input id="update-create-btn" class="normalbutton"  type="button" style="float:right;" value="Create">
          <h2>Choose a date : </h2>
          <div class="inner-block">
              <table class="create-date-table">
                  <tr><td>Date</td><td></td><td>Month</td><td></td><td>Year</td><td>Hour</td><td></td><td>Min</td></tr>
            <tr><td><select id="create-date"><option>dd</option></select></td><td>/</td>
            <td><select id="create-month"><option>mm</option></select></td><td>/</td>
            <td><select id="create-yr"><option>yy</option></select></td> 
            <td><select id="create-hr"><option>hr</option></select></td><td>:</td>
            <td><select id="create-min"><option>min</option></select></td></tr>
            </table>
          </div>

          <table class="time-table">
            <tr> <td> Timestamp </td><td>: <input type="text" id="create-timestamp" value=''></td></tr>
            <tr> <td> Time </td><td>: <span id="create-timestamp-human"></span></td></tr>
            <tr> <td> Timezone </td><td>: <span id="create-timezone-human"></span></td></tr>
          </table>
        </div>

        <div class="content-block">
          <input id="copy-custom-btn" class="normalbutton"  type="button" style="float:right;" value="Copy->">
          <input id="update-custom-btn" class="normalbutton"  type="button" style="float:right;" value="Display">
          <h2>Timestamp to Date : </h2>
          <table class="time-table">
            <tr> <td> Timestamp </td><td>: <input type="text" id="custom-timestamp" value=''></td></tr>
            <tr> <td> Time </td><td>: <span id="custom-timestamp-human"></span></td></tr>
            <tr> <td> Timezone </td><td>: <span id="custom-timezone-human"></span></td></tr>
          </table>
        </div>
      </div>
      <div class="content-block" style="float:left;">
        <h2>Calculate</h2>
        <h3>Initial:</h3>
        <table class="time-table">
          <tr> <td> Time </td><td>: <span id="initial-timestamp-human"></span></td></tr>
          <tr> <td> Timezone </td><td>: <span id="initial-timezone-human"></span></td></tr>
          <tr> <td> Timestamp </td><td>: <input type="text" id="initial-timestamp" value=''></td></tr>
        </table>

        <div class="inner-block" style="margin:30px 0;">
          <select id="operation"><option value="add">Add</option><option value="sub">Sub</option></select>
          <select id="calc-yr"></select> Yrs
          <select id="calc-month"></select> Months
          <select id="calc-days"></select> Days
          <select id="calc-hrs"></select> Hrs
          <div style="text-align:center; margin:5px;" >
          <input class="normalbutton"  type="button" style="margin:2px auto;" value="Calculate" id="calculate">
          </div>
        </div>
        <h3>Calculated:</h3>
        <table class="time-table">
          <tr> <td> Time </td><td>: <span id="calculated-timestamp-human"></span></td></tr>
          <tr> <td> Timezone </td><td>: <span id="calculated-timezone-human"></span></td></tr>
          <tr> <td> Timestamp </td><td>: <input type="text" id="calculated-timestamp" value=''></td></tr>
        </table>
      </div>
    </div>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://hacks.bluesmoon.info/strftime/strftime-min.js"></script>
    <script type="text/javascript">
      var Timestamp = { current : {}, custom : {}, create : {}};
    
    (function(){
     Timestamp.HUMANTIME = '%a, %d %b \'%y %I:%M:%S %p';
     Timestamp.TIMEZONE  = '%Z (%z)';
     Timestamp.timer     = 0;
     Timestamp.update = function() {
       Timestamp.current.dateObj     = new Date();
       Timestamp.current.timeStamp   =  Math.floor(Number(Timestamp.current.dateObj / 1000));
       Timestamp.current.timeString  = Timestamp.current.dateObj.strftime(Timestamp.HUMANTIME);
       Timestamp.current.timeZoneStr = Timestamp.current.dateObj.strftime(Timestamp.TIMEZONE);

       $('#current-timestamp').val(Timestamp.current.timeStamp);
       $('#current-timestamp-human').html(Timestamp.current.timeString);
       $('#current-timezone-human').html(Timestamp.current.timeZoneStr);
     }
     
    

     Timestamp.createFromTimestamp = function () {
        var year  = $('#create-yr').val();
        var month = $('#create-month').val();
        var dt    = $('#create-date').val();
        var hr    = $('#create-hr').val();
        var min   = $('#create-min').val();
        Timestamp.create.dateObj     = new Date(year, month - 1, dt, hr, min);
        Timestamp.create.timeStamp   = Math.floor(Number(Timestamp.create.dateObj / 1000));
        Timestamp.create.timeString  = Timestamp.create.dateObj.strftime(Timestamp.HUMANTIME);
        Timestamp.create.timeZoneStr = Timestamp.create.dateObj.strftime(Timestamp.TIMEZONE);
        
        $('#create-timestamp').val(Timestamp.create.timeStamp);
        $('#create-timestamp-human').html(Timestamp.create.timeString);
        $('#create-timezone-human').html(Timestamp.create.timeZoneStr);
     }

     Timestamp.calculate = function() {
         var yr    = $('#calc-yr').val();
         var month = $('#calc-month').val();
         var days  = $('#calc-days').val();
         var hrs   = $('#calc-hrs').val();
         var difference = yr*365*24*3600;
         difference += month*30*24*3600;
         difference += days*24*3600;
         difference += hrs*3600;
         if($('#operation').val() == 'sub')
            difference = difference * -1;

         var newts = Number($('#initial-timestamp').val())  + difference;
         var newdate = new Date(newts*1000);
         $('#calculated-timestamp').val(newts);
         $('#calculated-timestamp-human').html(newdate.strftime(Timestamp.HUMANTIME));
         $('#calculated-timezone-human').html(newdate.strftime(Timestamp.TIMEZONE));
     }


     Timestamp.customCalculate = function () {
        var ts = $('#custom-timestamp').val();
        Timestamp.custom.dateObj     = new Date(ts*1000);
        Timestamp.custom.timeStamp   = Math.floor(Number(Timestamp.custom.dateObj / 1000));
        Timestamp.custom.timeString  = Timestamp.custom.dateObj.strftime(Timestamp.HUMANTIME);
        Timestamp.custom.timeZoneStr = Timestamp.custom.dateObj.strftime(Timestamp.TIMEZONE);
        
        $('#custom-timestamp-human').html(Timestamp.custom.timeString);
        $('#custom-timezone-human').html(Timestamp.custom.timeZoneStr);
     }

     Timestamp.copy = function(evt) {
       var source = evt.data.src;
       if(source  == 'current')
       {
         var timeObj = Timestamp.current;
       } else if (source == 'create') {
         var timeObj = Timestamp.create;
       } else {
         var timeObj = Timestamp.custom;
       }

       $('#initial-timestamp').val(timeObj.timeStamp);
       $('#initial-timestamp-human').html(timeObj.timeString);
       $('#initial-timezone-human').html(timeObj.timeZoneStr);
     }

     Timestamp.filltime = function(node,limit,start) {
       if(!start) 
          start = 0;
        for(var i=start;i<limit;i++)
        {
          if(i < 10) 
          {
            var stringi = '0' + i;
          } 
          else
          {
            var stringi = i;
          }
          $('#' + node).append("<option value='"+ i +"'>"+ stringi +"</option>"); 
        }
     }
     
     Timestamp.togglePause = function() {
       if(Timestamp.timer) {
           clearInterval(Timestamp.timer);
           Timestamp.timer = 0;
           $('#toggleupdate').val('Play');
       } 
       else
       {
           Timestamp.timer = setInterval(Timestamp.update,1000);
           $('#toggleupdate').val('Pause');
       }
     };
     
     Timestamp.chooserSetTime = function() {
         var curDate = new Date();
         console.log(curDate.getFullYear());
         
         $('#create-yr').val(curDate.getFullYear());
         $('#create-month').val(curDate.getMonth());
         $('#create-date').val(curDate.getDate());
         $('#create-hr').val(curDate.getHours());
         $('#create-min').val(curDate.getMinutes());
     }

     $('#copybtn').bind('click', {src : 'current'}, Timestamp.copy);
     $('#current-timestamp').bind('focus',function(){this.select();});
     $('#initial-timestamp').bind('focus',function(){this.select();});
     $('#calculated-timestamp').bind('focus',function(){this.select();});
     $('#copy-create-btn').bind('click', {src : 'create'}, Timestamp.copy);
     $('#update-create-btn').bind('click',Timestamp.createFromTimestamp);
     $('#copy-custom-btn').bind('click', {src : 'custom'}, Timestamp.copy);
     $('#update-custom-btn').bind('click',Timestamp.customCalculate);
     $('#toggleupdate').bind('click',Timestamp.togglePause);
     $('#calculate').bind('click',Timestamp.calculate);
     Timestamp.filltime('create-yr',2999,1970);
     Timestamp.filltime('create-month',13,1);
     Timestamp.filltime('create-date',32,1);
     Timestamp.filltime('create-hr',24,0);
     Timestamp.filltime('create-min',60,0);

     Timestamp.filltime('calc-yr',99);
     Timestamp.filltime('calc-month',99);
     Timestamp.filltime('calc-days',99);
     Timestamp.filltime('calc-hrs',99);

     Timestamp.update();
     Timestamp.copy({ data : { src : 'current'}});
     Timestamp.chooserSetTime();
     
     Timestamp.timer = setInterval(Timestamp.update, 1000);

     })();
    </script>
    <div style="width: 50%; margin: 50px auto; border: 1px solid rgb(119, 119, 119); padding: 10px;">
      <h3>Changelog</h3>
      <table>
        <tr><td>2011-05-26</td><td>Added 00 as per manu's request</td></tr>
        <tr><td>2011-05-25</td><td>Add auto update, choose date shows current date</td></tr>
        <tr><td>2011-04-20</td><td>Fix the minute issue</td></tr>
        <tr><td>2010-12-06</td><td>Creating date from timestamp and dropdown works now, added this changelog</td></tr>
        <tr><td>2010-09-02</td><td>First release</td></tr>
      </table>
    </div>
  </body>
</html>
